{"ts":1359741653258,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1359741671995,"patch":[[{"diffs":[[1,"// Module dependencies\r\nvar http = require('http'),\r\n    express = require('express'),\r\n    crypto = require('crypto');\r\n\r\n\r\n\r\n\r\nvar Base64 = {\r\n\r\n// private property\r\n_keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\r\n\r\n// public method for encoding\r\nencode : function (input) {\r\n    var output = \"\";\r\n    var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\r\n    var i = 0;\r\n\r\n    input = Base64._utf8_encode(input);\r\n\r\n    while (i < input.length) {\r\n\r\n        chr1 = input.charCodeAt(i++);\r\n        chr2 = input.charCodeAt(i++);\r\n        chr3 = input.charCodeAt(i++);\r\n\r\n        enc1 = chr1 >> 2;\r\n        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n        enc4 = chr3 & 63;\r\n\r\n        if (isNaN(chr2)) {\r\n            enc3 = enc4 = 64;\r\n        } else if (isNaN(chr3)) {\r\n            enc4 = 64;\r\n        }\r\n\r\n        output = output +\r\n        this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\r\n        this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\r\n\r\n    }\r\n\r\n    return output;\r\n},\r\n\r\n// public method for decoding\r\ndecode : function (input) {\r\n    var output = \"\";\r\n    var chr1, chr2, chr3;\r\n    var enc1, enc2, enc3, enc4;\r\n    var i = 0;\r\n\r\n    input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n\r\n    while (i < input.length) {\r\n\r\n        enc1 = this._keyStr.indexOf(input.charAt(i++));\r\n        enc2 = this._keyStr.indexOf(input.charAt(i++));\r\n        enc3 = this._keyStr.indexOf(input.charAt(i++));\r\n        enc4 = this._keyStr.indexOf(input.charAt(i++));\r\n\r\n        chr1 = (enc1 << 2) | (enc2 >> 4);\r\n        chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n        chr3 = ((enc3 & 3) << 6) | enc4;\r\n\r\n        output = output + String.fromCharCode(chr1);\r\n\r\n        if (enc3 != 64) {\r\n            output = output + String.fromCharCode(chr2);\r\n        }\r\n        if (enc4 != 64) {\r\n            output = output + String.fromCharCode(chr3);\r\n        }\r\n\r\n    }\r\n\r\n    output = Base64._utf8_decode(output);\r\n\r\n    return output;\r\n\r\n},\r\n\r\n// private method for UTF-8 encoding\r\n_utf8_encode : function (string) {\r\n    string = string.replace(/\\r\\n/g,\"\\n\");\r\n    var utftext = \"\";\r\n\r\n    for (var n = 0; n < string.length; n++) {\r\n\r\n        var c = string.charCodeAt(n);\r\n\r\n        if (c < 128) {\r\n            utftext += String.fromCharCode(c);\r\n        }\r\n        else if((c > 127) && (c < 2048)) {\r\n            utftext += String.fromCharCode((c >> 6) | 192);\r\n            utftext += String.fromCharCode((c & 63) | 128);\r\n        }\r\n        else {\r\n            utftext += String.fromCharCode((c >> 12) | 224);\r\n            utftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n            utftext += String.fromCharCode((c & 63) | 128);\r\n        }\r\n\r\n    }\r\n\r\n    return utftext;\r\n},\r\n\r\n// private method for UTF-8 decoding\r\n_utf8_decode : function (utftext) {\r\n    var string = \"\";\r\n    var i = 0;\r\n    var c = c1 = c2 = 0;\r\n\r\n    while ( i < utftext.length ) {\r\n\r\n        c = utftext.charCodeAt(i);\r\n\r\n        if (c < 128) {\r\n            string += String.fromCharCode(c);\r\n            i++;\r\n        }\r\n        else if((c > 191) && (c < 224)) {\r\n            c2 = utftext.charCodeAt(i+1);\r\n            string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\r\n            i += 2;\r\n        }\r\n        else {\r\n            c2 = utftext.charCodeAt(i+1);\r\n            c3 = utftext.charCodeAt(i+2);\r\n            string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n            i += 3;\r\n        }\r\n\r\n    }\r\n\r\n    return string;\r\n}\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n  \r\nvar app = module.exports = express.createServer(),\r\n    blackoutAPI = http.createClient(80, 'http://api.blackoutrugby.com');\r\n\r\n// Configuration\r\napp.configure(function(){\r\n    app.set('views', __dirname + '/views');\r\n    app.set('view engine', 'ejs');\r\n    app.use(express.bodyParser());\r\n    app.use(express.methodOverride());\r\n    app.use(app.router);\r\n    app.use(express.static(__dirname + '/public'));\r\n});\r\n\r\napp.configure('development', function(){\r\n    app.use(express.errorHandler({ dumpExceptions: true, showStack: true })); \r\n});\r\n\r\napp.configure('production', function(){\r\n    app.use(express.errorHandler()); \r\n});\r\n\r\napp.use(express.bodyParser());\r\n\r\n// Routes\r\n\r\napp.get('/binary/:message', function(req, res){\r\n  var result = cryptoTest(req.params.message, 'GO8FzK17iPYKE2Kt', 'E2I51NEwsC3RdSNl', 'binary');\r\n\tres.send(req.params.message + \r\n\t\t' <br/><br/> ' + \r\n\t\tresult.encrypted + \r\n\t\t' <br/><br/> ' + \r\n\t\tresult.decrypted + \r\n\t\t' <br/><br/> ' + \r\n\t\t'<a href=\"http://api.blackoutrugby.com/?d=19&er=' + result.encrypted + '\">http://api.blackoutrugby.com/?d=19&er=' + result.encrypted + '</a>');\r\n});\r\n\r\napp.get('/base64/:message', function(req, res){\r\n\tvar result = cryptoTest(req.params.message, 'GO8FzK17iPYKE2Kt', 'E2I51NEwsC3RdSNl', 'base64');\r\n\tres.send(req.params.message + \r\n\t\t' <br/><br/> ' + \r\n\t\tresult.encrypted + \r\n\t\t' <br/><br/> ' + \r\n\t\tresult.decrypted + \r\n\t\t' <br/><br/> ' + \r\n\t\t'<a href=\"http://api.blackoutrugby.com/?d=19&er=' + result.encrypted + '\">http://api.blackoutrugby.com/?d=19&er=' + result.encrypted + '</a>');\r\n});\r\n\r\nfunction cryptoTest(data, key, iv, format) {\r\n\tvar cipher = crypto.createCipheriv('aes-128-cbc', key, iv);\r\n\tvar cipherChunks = [];\r\n\tcipherChunks.push(cipher.update(data, 'utf8', format));\r\n\tcipherChunks.push(cipher.final());\r\n\r\n\tvar decipher = crypto.createDecipheriv('aes-128-cbc', key, iv);\r\n\tvar plainChunks = [];\r\n\tfor (var i = 0;i < cipherChunks.length;i++) {\r\n\t  plainChunks.push(decipher.update(cipherChunks[i], format, 'utf8'));\r\n\t}\r\n\tplainChunks.push(decipher.final());\r\n\r\n\treturn {\r\n\t\t\"encrypted\": Base64.encode(cipherChunks.join('')),\r\n\t\t\"decrypted\": plainChunks.join('')\r\n\t};\r\n}\r\n\r\n// Only listen on $ node app.js\r\nif (!module.parent) {\r\n    app.listen(3000);\r\n    console.log(\"Express server listening on port %d\", app.address().port);\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":5880}]],"length":5880,"saved":false}
{"ts":1359741931815,"patch":[[{"diffs":[[0,"\r\n}\r\n\r\n}"],[1,";"],[0,"\r\n\r\n\r\n\r\n"]],"start1":3539,"start2":3539,"length1":16,"length2":17},{"diffs":[[0,"),\r\n    "],[1,"//"],[0,"blackout"]],"start1":3612,"start2":3612,"length1":16,"length2":18}]],"length":5883,"saved":false}
{"ts":1359741974938,"patch":[[{"diffs":[[0,"Server()"],[-1,","],[1,";"],[0,"\r\n    //"]],"start1":3605,"start2":3605,"length1":17,"length2":17}]],"length":5883,"saved":false}
{"ts":1359742118911,"patch":[[{"diffs":[[0,"app.js\r\n"],[1,"var port = process.env.PORT || 5000;\r\n"],[0,"if (!mod"]],"start1":5751,"start2":5751,"length1":16,"length2":54},{"diffs":[[0,"ten("],[-1,"3000"],[1,"port"],[0,");\r\n"]],"start1":5831,"start2":5831,"length1":12,"length2":12},{"diffs":[[0,"%d\","],[-1," app.address()."],[0,"port"],[1," "],[0,");\r\n"]],"start1":5893,"start2":5893,"length1":27,"length2":13}]],"length":5907,"saved":false}
{"ts":1359742403662,"patch":[[{"diffs":[[0,"teCipheriv('aes-"],[-1,"128"],[1,"256"],[0,"-cbc', key, iv);"]],"start1":5201,"start2":5201,"length1":35,"length2":35},{"diffs":[[0,"iv('aes-"],[-1,"128"],[1,"256"],[0,"-cbc', k"]],"start1":5397,"start2":5397,"length1":19,"length2":19}]],"length":5907,"saved":false}
{"ts":1359742484886,"patch":[[{"diffs":[[0,"teCipheriv('aes-"],[-1,"256"],[1,"128"],[0,"-cbc', key, iv);"]],"start1":5201,"start2":5201,"length1":35,"length2":35},{"diffs":[[0,"aes-"],[-1,"256"],[1,"128"],[0,"-cbc"]],"start1":5401,"start2":5401,"length1":11,"length2":11}]],"length":5907,"saved":false}
{"ts":1359747118241,"patch":[[{"diffs":[[0,"eq, res){\r\n\t"],[1,"//"],[0,"var result ="]],"start1":4726,"start2":4726,"length1":24,"length2":26},{"diffs":[[0,"'base64');\r\n"],[1,"  var result = cryptoTest(req.params.message, 'LpAHsjmXvzsj7h84UEgRYoXV/U4viJClViRvfOOc/k8=', 'v4645jS75BWw8PjJmRmXYQ==', 'base64');\r\n"],[0,"\tres.send(re"]],"start1":4824,"start2":4824,"length1":24,"length2":158}]],"length":6043,"saved":false}
{"ts":1359747154833,"patch":[[{"diffs":[[0,"teCipheriv('aes-"],[-1,"128"],[1,"256"],[0,"-cbc', key, iv);"]],"start1":5337,"start2":5337,"length1":35,"length2":35},{"diffs":[[0,"iv('aes-"],[-1,"128"],[1,"256"],[0,"-cbc', k"]],"start1":5533,"start2":5533,"length1":19,"length2":19}]],"length":6043,"saved":false}
{"ts":1359747217516,"patch":[[{"diffs":[[0,"res){\r\n\t"],[-1,"//"],[0,"var resu"]],"start1":4730,"start2":4730,"length1":18,"length2":16},{"diffs":[[0,");\r\n"],[-1,"  var result = cryptoTest(req.params.message, 'LpAHsjmXvzsj7h84UEgRYoXV/U4viJClViRvfOOc/k8=', 'v4645jS75BWw8PjJmRmXYQ==', 'base64');\r\n"],[0,"\tres"]],"start1":4830,"start2":4830,"length1":142,"length2":8},{"diffs":[[0,"teCipheriv('aes-"],[-1,"256"],[1,"128"],[0,"-cbc', key, iv);"]],"start1":5201,"start2":5201,"length1":35,"length2":35},{"diffs":[[0,"aes-"],[-1,"256"],[1,"128"],[0,"-cbc"]],"start1":5401,"start2":5401,"length1":11,"length2":11}]],"length":5907,"saved":false}
{"ts":1359750993405,"patch":[[{"diffs":[[0," Routes\r"],[1,"\nvar iv = Base64._utf8_encode(Base64.decode(\"v4645jS75BWw8PjJmRmXYQ==\"));\r\nvar key = Base64._utf8_encode(Base64.decode(\"LpAHsjmXvzsj7h84UEgRYoXV/U4viJClViRvfOOc/k8=\"));\r"],[0,"\n\r\napp.g"]],"start1":4234,"start2":4234,"length1":16,"length2":185},{"diffs":[[0,"ge, "],[-1,"'GO8FzK17iPYKE2Kt', 'E2I51NEwsC3RdSNl'"],[1,"key, iv"],[0,", 'b"]],"start1":4505,"start2":4505,"length1":46,"length2":15}]],"length":6045,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359751311164,"patch":[[{"diffs":[[0,"\n// Routes\r\n"],[1,"\r\n\r\napp.get('/binary/:message', function(req, res){\r\n  "],[0,"var iv = Bas"]],"start1":4231,"start2":4231,"length1":24,"length2":79},{"diffs":[[0,"));\r"],[-1,"\n\r\napp.get('/binary/:message', function(req, res){\r"],[0,"\n  v"]],"start1":4462,"start2":4462,"length1":59,"length2":8}]],"length":6049,"saved":false}
{"ts":1359751327191,"patch":[[{"diffs":[[0,"t('/"],[-1,"binary/"],[0,":mes"]],"start1":4253,"start2":4253,"length1":15,"length2":8}]],"length":6042,"saved":false}
{"ts":1359751442916,"patch":[[{"diffs":[[0,"js\r\n"],[-1,"var port = process.env.PORT || 5000;\r\n"],[0,"if ("]],"start1":5890,"start2":5890,"length1":46,"length2":8},{"diffs":[[0,"listen(p"],[-1,"ort"],[1,"rocess.env.PORT"],[0,");\r\n    "]],"start1":5925,"start2":5925,"length1":19,"length2":31},{"diffs":[[0,"ort %d\","],[-1,"port "],[1," app.address().process.env.PORT"],[0,");\r\n}"]],"start1":5998,"start2":5998,"length1":18,"length2":44}]],"length":6042,"saved":false}
{"ts":1359751473440,"patch":[[{"diffs":[[0,"p.get('/"],[1,"binary/"],[0,":message"]],"start1":4249,"start2":4249,"length1":16,"length2":23},{"diffs":[[0,"){\r\n"],[-1,"  var iv = Base64._utf8_encode(Base64.decode(\"v4645jS75BWw8PjJmRmXYQ==\"));\r\nvar key = Base64._utf8_encode(Base64.decode(\"LpAHsjmXvzsj7h84UEgRYoXV/U4viJClViRvfOOc/k8=\"));\r\n"],[0,"  va"]],"start1":4292,"start2":4292,"length1":179,"length2":8},{"diffs":[[0,"app.js\r\n"],[1,"var port = process.env.PORT || 5000;\r\n"],[0,"if (!mod"]],"start1":5722,"start2":5722,"length1":16,"length2":54},{"diffs":[[0,"listen(p"],[-1,"rocess.env.PORT"],[1,"ort"],[0,");\r\n    "]],"start1":5799,"start2":5799,"length1":31,"length2":19},{"diffs":[[0,"%d\","],[-1," app.address().process.env.PORT"],[1,"port "],[0,");\r\n"]],"start1":5864,"start2":5864,"length1":39,"length2":13}]],"length":5878,"saved":false}
{"ts":1359751583583,"patch":[[{"diffs":[[0,"Routes\r\n"],[1,"var iv = Base64._utf8_encode(Base64.decode(\"v4645jS75BWw8PjJmRmXYQ==\"));\r\nvar key = Base64._utf8_encode(Base64.decode(\"LpAHsjmXvzsj7h84UEgRYoXV/U4viJClViRvfOOc/k8=\"));"],[0,"\r\n\r\napp."]],"start1":4235,"start2":4235,"length1":16,"length2":183},{"diffs":[[0," || "],[-1,"500"],[1,"808"],[0,"0;\r\n"]],"start1":5924,"start2":5924,"length1":11,"length2":11}]],"length":6045,"saved":false}
